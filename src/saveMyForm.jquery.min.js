(function(a,b){'use strict';function c(c,d){this.element=c,this.settings=a.extend({},a.fn.saveMyForm.defaults,d),this._name='saveMyForm',this._loadingList={},this._elementList=[];var e=a(c);if(this._formName=void 0===this.settings.formName?void 0===e.attr('id')?void 0===e.attr('name')?void 0:e.attr('name'):e.attr('id'):this.settings.formName,null==this._formName){var f=a('form').index(e);if(-1!==f)this._formName=b.location.pathname+'_formindex_'+f;else return void console.log('Unable to save form data - no id, name or index found')}!0===this.settings.addPathToName&&(this._formName=this._formName+'___'+b.location.pathname.slice(this.settings.addPathLength)),this.init()}// Plugin defaults
a.extend(c.prototype,{init:function(){var b=this;this._elementList=this.getElementList(),a(this.element).find(':input').each(function(){b.addElement(this)}),this.storeElementList(),!0===this.settings.resetOnSubmit&&a(this.element).submit(function(){b.clearStorage()})},addElement:function(b){if(!a(b).is(this.settings.exclude)&&(null===this.settings.include||a(b).is(this.settings.include))){var c=this,d=this.getName(b);d&&(a(b).change(function(a){c.storeElement(a)}).keyup(debounce(function(a){c.storeElement(a)},500)),void 0===this._loadingList[d]?this._loadingList[d]=0:!a(b).is(':radio')&&(this._loadingList[d]++,a.data(b,'multiple',this._loadingList[d]),d=d+this.settings.sameNameSeparator+this._loadingList[d]),-1===this._elementList.indexOf(d)&&this._elementList.push(d),!0===this.settings.loadInputs&&this.loadElement(b))}},loadElement:function(b){var c=this.getName(b),d=localStorage.getItem(c);null!==d&&(d=JSON.parse(d),a(b).is(':checkbox')?a(b).prop('checked',d):a(b).is(':radio')?d==a(b).val()&&a(b).prop('checked',!0):a(b).val(d))},storeElement:function(b){var c,d=this.getName(b.target),e=a(b.target);d&&(c=a(b.target).is(':checkbox')?e.prop('checked'):e.val(),localStorage.setItem(d,JSON.stringify(c)))},getElementList:function(){return a.fn.saveMyForm.getElementListByFormName(this._formName)},storeElementList:function(){localStorage.setItem('elementList_'+this._formName,JSON.stringify(this._elementList))},clearElementList:function(){localStorage.removeItem('elementList_'+this._formName)},clearStorage:function(){a.fn.saveMyForm.clearStorageByFormName(this._formName)},getName:function(b){var c=a(b),d=c.attr('id')===void 0?c.attr('name')===void 0?void 0:c.attr('name'):c.attr('id');return void 0===d?void 0:this._formName+'_'+d+(a.data(b,'multiple')===void 0?'':this.settings.sameNameSeparator+a.data(b,'multiple'))}}),a.fn.saveMyForm=function(b,d){return this.each(function(){var e=a.data(this,'plugin_saveMyForm');if(!e){var f='object'==typeof b?b:{};e=a.data(this,'plugin_saveMyForm',new c(this,f))}'string'==typeof b&&'function'==typeof e[b]&&('array'!=typeof d&&(d=[d]),e[b].apply(e,d))})},a.fn.saveMyForm.defaults={exclude:':password, :hidden, :file, .disable_save',include:null,formName:void 0,addPathToName:!1,addPathLength:-255,loadInputs:!0,sameNameSeparator:'___',resetOnSubmit:!0},a.fn.saveMyForm.getElementListByFormName=function(a){return JSON.parse(localStorage.getItem('elementList_'+a))||[]},a.fn.saveMyForm.clearStorageByFormName=function(b){try{var c=a.fn.saveMyForm.getElementListByFormName(b);if(0<c.length)return a.each(c,function(a,b){localStorage.removeItem(b)}),!0}catch(a){console.log(a)}return!1}})(jQuery,window,document);// Underscore debounce function
function debounce(a,b,c){function d(){var j=Date.now()-h;j<b&&0<=j?e=setTimeout(d,b-j):(e=null,!c&&(i=a.apply(g,f),g=f=null))}var e,f,g,h,i;null==b&&(b=100);var j=function(){g=this,f=arguments,h=Date.now();var j=c&&!e;return e||(e=setTimeout(d,b)),j&&(i=a.apply(g,f),g=f=null),i};return j.clear=function(){e&&(clearTimeout(e),e=null)},j.flush=function(){e&&(i=a.apply(g,f),g=f=null,clearTimeout(e),e=null)},j}